<html>
<body>
  <h2>Login</h2>
  <form id="loginForm">
    <label for="username">Username:</label>
    <input type="text" id="username" name="username"><br>
    <label for="password">Password:</label>
    <input type="password" id="password" name="password"><br>
    <button type="submit">Login</button>
  </form>

  <h2>Upload Lesson</h2>
  <form id="uploadForm">
    <input type="file" id="lessonFile" name="lessonFile"><br>
    <button type="submit">Upload Lesson</button>
  </form>

  <script>
    document.getElementById("loginForm").addEventListener("submit", function(event) {
      event.preventDefault();
      const username = document.getElementById("username").value;
      const password = document.getElementById("password").value;

      fetch('https://thepocketproaiservice.online/auth/login', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ username, password }),
      })
      .then(response => response.json())
      .then(data => {
        if (data.token) {
          localStorage.setItem('token', data.token); // Save token
          alert('Login Successful');
        } else {
          alert('Login Failed');
        }
      });
    });

    document.getElementById("uploadForm").addEventListener("submit", function(event) {
      event.preventDefault();
      const token = localStorage.getItem('token');
      const file = document.getElementById("lessonFile").files[0];
      
      const formData = new FormData();
      formData.append('file', file);

      fetch('https://thepocketproaiservice.online/upload_lesson', {
        method: 'POST',
        headers: {
          'Authorization': 'Bearer ' + token,
        },
        body: formData,
      })
      .then(response => response.json())
      .then(data => {
        alert('Upload Success');
      })
      .catch(error => alert('Upload Failed'));
    });
  </script>
</body>
</html>
